create table filme (
    id uuid not null primary key,
    titulo varchar(100) not null,
    sinopse varchar(500) not null,
    genero varchar(30) not null,
    ano_lancamento INTEGER not null,
    data_cadastro timestamp,
    data_atualizacao timestamp
);


create table review (
    id uuid not null primary key,
    id_filme uuid not null references filme(id),
    texto varchar(5000) not null,
    nota numeric(14,2) not null,
    data_cadastro timestamp,
    data_atualizacao timestamp,
    id_usuario uuid references usuario(id)
   );


create table usuario (
    id uuid not null primary key,
    login varchar(20) not null unique,
    senha varchar(300) not null,
    roles varchar[],
    email varchar(150) not null
);


create table lista (
    id uuid not null primary key,
    id_usuario uuid not null references usuario(id),
    titulo varchar(100) not null,
    descricao varchar(1000) not null,
    data_criacao timestamp,
    data_modificacao timestamp
);


CREATE TABLE lista_filme (
    lista_id UUID NOT NULL,
    filme_id UUID NOT NULL,

    CONSTRAINT fk_lista FOREIGN KEY (lista_id) REFERENCES lista (id) ON DELETE CASCADE,
    CONSTRAINT fk_filme FOREIGN KEY (filme_id) REFERENCES filme (id) ON DELETE CASCADE,

    PRIMARY KEY (lista_id, filme_id)
);

CREATE TABLE client(
    id uuid not null primary key,
    client_id varchar(150) not null,
    client_secret varchar(400) not null,
    redirect_uri varchar(200) not null,
    scope varchar(50)
);